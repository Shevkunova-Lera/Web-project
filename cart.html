<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Корзина покупок</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <section class="cart">
        <h1 class="cart__title">Shopping Cart</h1>
        <div class="cart__items">
            <div class="cart__item">
                <img src="lira-earrings.jpg" alt="Lira Earrings" class="cart__item-image">
                <div class="cart__item-details">
                    <h2 class="cart__item-title">Lira Earrings</h2>
                    <p class="cart__item-info">Black / Medium</p>
                    <p class="cart__item-price">$20,00</p>
                </div>
                <div class="cart__item-quantity">
                    <button class="cart__item-btn cart__item-btn--decrease">-</button>
                    <span class="cart__item-count">3</span>
                    <button class="cart__item-btn cart__item-btn--increase">+</button>
                </div>
                <button class="cart__item-remove">&times;</button>
            </div>
        </div>
        <div class="cart__summary">
            <p class="cart__summary-subtotal">Subtotal: <span>$65,00</span></p>
            <p class="cart__summary-shipping">Shipping: <span>$5,00</span></p>
            <p class="cart__summary-total">Total: <span>$87,00</span></p>
        </div>
        <div class="cart__actions">
            <input type="text" class="cart__coupon" placeholder="Coupon Code">
            <a class="cart__apply-btn">APPLY COUPON</a>
            <a href="shop.html" class="cart__update-btn">UPDATE CART</a>
            <a class="cart__checkout-btn">PROCEED TO CHECKOUT</a>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const cartContainer = document.querySelector('.cart__items');
            const subtotalElem = document.querySelector('.cart__summary-subtotal span');
            const totalElem = document.querySelector('.cart__summary-total span');
            const shippingCost = 5.00;

            function loadCart() {
                const savedCart = JSON.parse(localStorage.getItem('cart')) || [];
                savedCart.forEach(item => {
                    addItemToCart(item.title, item.info, item.price, item.image, item.quantity);
                });
                updateSummary();
            }

            function saveCart() {
                const cartItems = Array.from(document.querySelectorAll('.cart__item')).map(item => {
                    return {
                        title: item.querySelector('.cart__item-title').textContent,
                        info: item.querySelector('.cart__item-info').textContent,
                        price: item.querySelector('.cart__item-price').textContent,
                        image: item.querySelector('.cart__item-image').src,
                        quantity: parseInt(item.querySelector('.cart__item-count').textContent)
                    };
                });
                localStorage.setItem('cart', JSON.stringify(cartItems));
            }

            function updateSummary() {
                let subtotal = 0;
                document.querySelectorAll('.cart__item').forEach(item => {
                    const price = parseFloat(item.querySelector('.cart__item-price').textContent.replace('$', '').replace(',', '.'));
                    const quantity = parseInt(item.querySelector('.cart__item-count').textContent);
                    subtotal += price * quantity;
                });
                subtotalElem.textContent = `$${subtotal.toFixed(2)}`;
                totalElem.textContent = `$${(subtotal + shippingCost).toFixed(2)}`;
                saveCart();
            }

            function addItemToCart(title, info, price, image, quantity = 1) {
                const itemHTML = `
                    <div class="cart__item">
                        <img src="${image}" alt="${title}" class="cart__item-image">
                        <div class="cart__item-details">
                            <h2 class="cart__item-title">${title}</h2>
                            <p class="cart__item-info">${info}</p>
                            <p class="cart__item-price">${price}</p>
                        </div>
                        <div class="cart__item-quantity">
                            <button class="cart__item-btn cart__item-btn--decrease">-</button>
                            <span class="cart__item-count">${quantity}</span>
                            <button class="cart__item-btn cart__item-btn--increase">+</button>
                        </div>
                        <button class="cart__item-remove">&times;</button>
                    </div>`;
                cartContainer.insertAdjacentHTML('beforeend', itemHTML);
                updateEventListeners();
                updateSummary();
            }

            function updateEventListeners() {
                document.querySelectorAll('.cart__item-btn--decrease').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const countElem = btn.nextElementSibling;
                        let count = parseInt(countElem.textContent);
                        if (count > 1) {
                            countElem.textContent = count - 1;
                            updateSummary();
                        }
                    });
                });

                document.querySelectorAll('.cart__item-btn--increase').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const countElem = btn.previousElementSibling;
                        countElem.textContent = parseInt(countElem.textContent) + 1;
                        updateSummary();
                    });
                });

                document.querySelectorAll('.cart__item-remove').forEach(btn => {
                    btn.addEventListener('click', () => {
                        btn.closest('.cart__item').remove();
                        updateSummary();
                    });
                });
            }

            loadCart();
        });
    </script>
</body>

</html>